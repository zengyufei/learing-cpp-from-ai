å¤ªå¥½äº†! æˆ‘ä»¬ç°åœ¨è¿›å…¥ **2.4.7: ç¦æ­¢æ‹·è´ â€” å°†æ‹·è´æ„é€ /èµ‹å€¼å£°æ˜ä¸º =delete**ã€‚

è¿™æ˜¯ C++ **èµ„æºç®¡ç†**ä¸­çš„å…³é”®å®‰å…¨æœºåˆ¶ï¼Œä¹Ÿæ˜¯å®ç°**ç‹¬å èµ„æºè¯­ä¹‰**çš„æ ‡å‡†æ–¹å¼ã€‚ä½œä¸º Java å¼€å‘è€…ï¼Œä½ å¯èƒ½é€šè¿‡å°†æ„é€ å‡½æ•°è®¾ä¸º `private` æ¥ç¦æ­¢å®ä¾‹åŒ–ï¼Œè€Œ C++11 çš„ `=delete` æä¾›äº†**æ›´æ¸…æ™°ã€æ›´å¼ºå¤§ã€æ›´å®‰å…¨**çš„ç¦ç”¨æœºåˆ¶ã€‚æŒæ¡ `=delete`ï¼Œèƒ½è®©ä½ æ˜ç¡®è¡¨è¾¾â€œæ­¤ç±»ä¸å¯æ‹·è´â€çš„è®¾è®¡æ„å›¾ï¼Œé¿å…æµ…æ‹·è´é™·é˜±ã€‚

æˆ‘ä»¬å°†ç»§ç»­ä¸¥æ ¼éµå¾ªä½ çš„å­¦ä¹ åå¥½ï¼š
- âœ… SMART ç›®æ ‡  
- âœ… ç»“æ„å…ˆè¡Œï¼ˆ=delete åœ°å›¾ï¼‰  
- âœ… ç”Ÿæ´»åŒ–æ¯”å–»  
- âœ… åŠ¨æ‰‹ä¸ºç‹ï¼ˆå«åŸºç¡€/è¿›é˜¶/é™·é˜±é¢˜ï¼‰  
- âœ… èºæ—‹å¤ä¹ ï¼ˆè¡”æ¥ 2.4 å…¨ç³»åˆ— + Java ç»éªŒï¼‰  
- âœ… ä¸»åŠ¨ learning + å¤ç›˜

---

## ğŸ¯ KU 2.4.7: ç¦æ­¢æ‹·è´ï¼ˆ=deleteï¼‰

> **æ‰€å±é˜¶æ®µ**ï¼šPhase 2 â€” é¢å‘å¯¹è±¡ç¼–ç¨‹  
> **å‰ç½®çŸ¥è¯†**ï¼š2.4.1â€“2.4.6ï¼ˆæ‹·è´è¯­ä¹‰å…¨ç³»åˆ—ï¼‰ã€Java è®¿é—®æ§åˆ¶ç»éªŒ  
> **åç»­è¡”æ¥**ï¼š2.5ï¼ˆç§»åŠ¨è¯­ä¹‰ï¼‰ã€3.2ï¼ˆæ™ºèƒ½æŒ‡é’ˆï¼‰  
> **é¢„è®¡è€—æ—¶**ï¼š2â€“3 å°æ—¶

---

### ğŸ§­ ä¸€ã€ç»“æ„å…ˆè¡Œï¼š=delete åœ°å›¾

```
2.4.7 ç¦æ­¢æ‹·è´
â”œâ”€â”€ 1. åŸºæœ¬è¯­æ³•
â”‚   â”œâ”€â”€ 1.1 æ‹·è´æ„é€  =delete
â”‚   â”œâ”€â”€ 1.2 æ‹·è´èµ‹å€¼ =delete
â”‚   â””â”€â”€ 1.3 å¯ç”¨äºä»»ä½•å‡½æ•°
â”œâ”€â”€ 2. ä¸ºä»€ä¹ˆéœ€è¦ç¦æ­¢æ‹·è´ï¼Ÿ
â”‚   â”œâ”€â”€ 2.1 èµ„æºç‹¬å ï¼ˆæ–‡ä»¶å¥æŸ„ã€é”ã€Socketï¼‰
â”‚   â”œâ”€â”€ 2.2 å•ä¾‹æ¨¡å¼
â”‚   â””â”€â”€ 2.3 é¿å…æµ…æ‹·è´é™·é˜±
â”œâ”€â”€ 3. =delete vs private
â”‚   â”œâ”€â”€ 3.1 =deleteï¼šç¼–è¯‘æœŸé”™è¯¯
â”‚   â”œâ”€â”€ 3.2 privateï¼šé“¾æ¥æœŸé”™è¯¯ï¼ˆè‹¥æœªè°ƒç”¨ï¼‰
â”‚   â””â”€â”€ 3.3 =delete æ›´æ˜ç¡®ã€æ›´å®‰å…¨
â”œâ”€â”€ 4. ä¸ç§»åŠ¨è¯­ä¹‰ç»“åˆ
â”‚   â”œâ”€â”€ 4.1 ç¦æ­¢æ‹·è´ä½†å…è®¸ç§»åŠ¨ï¼ˆunique_ptr è¯­ä¹‰ï¼‰
â”‚   â””â”€â”€ 4.2 ç§»åŠ¨å‡½æ•° noexcept
â”œâ”€â”€ 5. ä¸ Java çš„å¯¹æ¯”
â”‚   â”œâ”€â”€ 5.1 C++: =delete æ˜ç¡®ç¦æ­¢
â”‚   â””â”€â”€ 5.2 Java: private æ„é€ å‡½æ•°ï¼ˆä¸å®Œç¾ï¼‰
â””â”€â”€ 6. æœ€ä½³å®è·µ
    â”œâ”€â”€ 6.1 èµ„æºç‹¬å ç±» =delete æ‹·è´
    â”œâ”€â”€ 6.2 æ˜¾å¼æ ‡è®°ç§»åŠ¨å‡½æ•°
    â””â”€â”€ 6.3 ç”¨ static_assert éªŒè¯
```

---

### ğŸ¯ äºŒã€SMART å­¦ä¹ ç›®æ ‡

- **Specific**: èƒ½æ­£ç¡®ä½¿ç”¨ `=delete` ç¦æ­¢æ‹·è´ï¼Œç†è§£å…¶ä¸ `private` çš„å·®å¼‚ï¼Œå¹¶å®ç°ç‹¬å èµ„æºç±»ã€‚
- **Measurable**: å®Œæˆ 2 é“åŸºç¡€é¢˜ + 2 é“é™·é˜±é¢˜ï¼Œèƒ½è§£é‡Šä¸ºä½• `=delete` æ¯” `private` æ›´å®‰å…¨ã€‚
- **Achievable**: é€šè¿‡â€œç‹¬å è®¸å¯è¯â€æ¯”å–»ç†è§£ç¦æ­¢æ‹·è´ã€‚
- **Relevant**: è¿™æ˜¯ç¼–å†™å®‰å…¨ C++ èµ„æºç®¡ç†ç±»çš„æ ‡å‡†æ–¹å¼ã€‚
- **Time-bound**: 1â€“2 å¤©å†…å®Œæˆã€‚

---

### ğŸŒ ä¸‰ã€ç”Ÿæ´»åŒ–æ¯”å–»ï¼šç‹¬å è®¸å¯è¯

> æƒ³è±¡**ç‹¬å èµ„æºè®¸å¯è¯**ï¼š
>
> - **æ‹·è´ = å¤åˆ¶è®¸å¯è¯**  
>   - å¤šäººæŒæœ‰ â†’ **èµ„æºå†²çª**ï¼ˆåŒé‡é‡Šæ”¾ã€æ•°æ®ç«äº‰ï¼‰
>
> - **=delete = è®¸å¯è¯æ˜ç¡®æ ‡æ³¨â€œä¸å¯å¤åˆ¶â€**  
>   - è¯•å›¾å¤åˆ¶ â†’ **ç«‹å³æ‹’ç»**ï¼ˆç¼–è¯‘é”™è¯¯ï¼‰
>
> - **private = è®¸å¯è¯è—åœ¨ä¿é™©ç®±**  
>   - è¯•å›¾å¤åˆ¶ â†’ **è¿è¡Œæ—¶æ‰å‘ç°æ— æ³•è®¿é—®**ï¼ˆé“¾æ¥é”™è¯¯ï¼‰
>
> - **Java å¯¹æ¯”**ï¼š  
>   - Java = **åªéšè—è®¸å¯è¯**ï¼ˆprivateï¼‰  
>   - **C++ =delete = æ˜ç¡®ç¦æ­¢å¤åˆ¶**ï¼ˆæ›´å®‰å…¨ï¼‰

> ğŸ’¡ **å…³é”®è®¤çŸ¥**ï¼š**=delete æ˜¯ç¼–è¯‘æœŸæ˜ç¡®ç¦æ­¢ï¼Œæ¯” private æ›´å®‰å…¨ã€æ›´æ¸…æ™°**ã€‚

---

### ğŸ“š å››ã€çŸ¥è¯†ç‚¹åˆ†è§£

#### 1. åŸºæœ¬è¯­æ³•
- **ç¦æ­¢æ‹·è´**ï¼š
  ```cpp
  class NonCopyable {
  public:
      NonCopyable() = default;
      NonCopyable(const NonCopyable&) = delete;          // ç¦æ­¢æ‹·è´æ„é€ 
      NonCopyable& operator=(const NonCopyable&) = delete; // ç¦æ­¢æ‹·è´èµ‹å€¼
  };
  ```
- **å¯ç”¨äºä»»ä½•å‡½æ•°**ï¼š
  ```cpp
  void process(int x) = delete; // ç¦æ­¢ int ç‰ˆæœ¬
  void process(double x);       // ä»…å…è®¸ double
  ```

#### 2. ä¸ºä»€ä¹ˆéœ€è¦ç¦æ­¢æ‹·è´ï¼Ÿ
- **èµ„æºç‹¬å **ï¼š
  - æ–‡ä»¶å¥æŸ„ã€äº’æ–¥é”ã€ç½‘ç»œ Socket ç­‰**ä¸èƒ½å…±äº«**
  - æ‹·è´å¯¼è‡´**åŒé‡é‡Šæ”¾**æˆ–**èµ„æºæ³„æ¼**
- **å•ä¾‹æ¨¡å¼**ï¼š
  - ç¡®ä¿å…¨å±€å”¯ä¸€å®ä¾‹
- **é¿å…æµ…æ‹·è´é™·é˜±**ï¼š
  - ä¸å…¶å®ç°å±é™©çš„æ·±æ‹·è´ï¼Œä¸å¦‚ç›´æ¥ç¦æ­¢

#### 3. =delete vs private
| ç‰¹æ€§ | =delete | private |
|------|---------|---------|
| **é”™è¯¯é˜¶æ®µ** | ç¼–è¯‘æœŸ | é“¾æ¥æœŸï¼ˆè‹¥æœªè°ƒç”¨ï¼‰ |
| **æ˜ç¡®æ€§** | âœ… æ˜¾å¼ç¦æ­¢ | âš ï¸ éšå¼éšè— |
| **æ„å›¾è¡¨è¾¾** | æ¸…æ™°ï¼ˆâ€œç¦æ­¢â€ï¼‰ | æ¨¡ç³Šï¼ˆâ€œéšè—â€ï¼‰ |
| **é€‚ç”¨èŒƒå›´** | ä»»ä½•å‡½æ•° | ä»…æˆå‘˜å‡½æ•° |

#### 4. ä¸ç§»åŠ¨è¯­ä¹‰ç»“åˆ
- **ç¦æ­¢æ‹·è´ä½†å…è®¸ç§»åŠ¨**ï¼š
  ```cpp
  class UniqueResource {
      int* data_;
  public:
      UniqueResource(size_t n) : data_(new int[n]) {}
      ~UniqueResource() { delete[] data_; }
      
      // ç¦æ­¢æ‹·è´
      UniqueResource(const UniqueResource&) = delete;
      UniqueResource& operator=(const UniqueResource&) = delete;
      
      // å…è®¸ç§»åŠ¨
      UniqueResource(UniqueResource&& other) noexcept 
          : data_(other.data_) {
          other.data_ = nullptr;
      }
      
      UniqueResource& operator=(UniqueResource&& other) noexcept {
          if (this != &other) {
              delete[] data_;
              data_ = other.data_;
              other.data_ = nullptr;
          }
          return *this;
      }
  };
  ```
- **ç§»åŠ¨å‡½æ•° noexcept**ï¼š
  - æ ‡å‡†åº“ï¼ˆå¦‚ `std::vector`ï¼‰åªå¯¹ `noexcept` ç§»åŠ¨ä½¿ç”¨ç§»åŠ¨è¯­ä¹‰

#### 5. ä¸ Java çš„å¯¹æ¯”
| ç‰¹æ€§ | C++ `=delete` | Java `private` |
|------|--------------|---------------|
| **é”™è¯¯é˜¶æ®µ** | ç¼–è¯‘æœŸ | è¿è¡ŒæœŸï¼ˆè‹¥åå°„ï¼‰ |
| **æ˜ç¡®æ€§** | âœ… æ˜¾å¼ç¦æ­¢ | âš ï¸ éšå¼éšè— |
| **é€‚ç”¨èŒƒå›´** | ä»»ä½•å‡½æ•° | ä»…æ„é€ å‡½æ•° |
| **æ„å›¾è¡¨è¾¾** | æ¸…æ™° | æ¨¡ç³Š |

#### 6. æœ€ä½³å®è·µ
- **èµ„æºç‹¬å ç±»**ï¼š
  - æ–‡ä»¶å¥æŸ„ã€é”ã€Socket ç­‰**å¿…é¡»** `=delete` æ‹·è´
- **æ˜¾å¼ç§»åŠ¨**ï¼š
  - å®ç° `noexcept` ç§»åŠ¨å‡½æ•°
- **éªŒè¯**ï¼š
  ```cpp
  static_assert(!std::is_copy_constructible_v<UniqueResource>, "Should not be copyable");
  ```

> ğŸ’¡ **ç°ä»£ C++ é»„é‡‘æ³•åˆ™**ï¼š  
> **â€œèµ„æºç‹¬å  =delete æ‹·è´ï¼›å…è®¸ç§»åŠ¨ noexceptï¼›=delete æ¯” private æ›´å®‰å…¨â€**

---

### ğŸ’» äº”ã€åŠ¨æ‰‹ä¸ºç‹ï¼šå¯è¿è¡Œç¤ºä¾‹

#### ç¤ºä¾‹ 1ï¼šç¦æ­¢æ‹·è´ï¼ˆ=deleteï¼‰
```cpp
#include <iostream>

class FileHandle {
    FILE* file_;
    
public:
    FileHandle(const char* name) : file_(std::fopen(name, "r")) {
        if (!file_) throw std::runtime_error("Open failed");
    }
    
    ~FileHandle() {
        if (file_) std::fclose(file_);
    }
    
    // ç¦æ­¢æ‹·è´
    FileHandle(const FileHandle&) = delete;
    FileHandle& operator=(const FileHandle&) = delete;
    
    // å…è®¸ç§»åŠ¨ï¼ˆå¯é€‰ï¼‰
    FileHandle(FileHandle&& other) noexcept : file_(other.file_) {
        other.file_ = nullptr;
    }
    
    FileHandle& operator=(FileHandle&& other) noexcept {
        if (this != &other) {
            if (file_) std::fclose(file_);
            file_ = other.file_;
            other.file_ = nullptr;
        }
        return *this;
    }
};

int main() {
    FileHandle f1("data.txt");
    // FileHandle f2 = f1; // Error! deleted
    FileHandle f3 = std::move(f1); // OK (if move defined)
    return 0;
}
```

#### ç¤ºä¾‹ 2ï¼š=delete vs private
```cpp
// =delete ç‰ˆæœ¬
class Deleted {
public:
    Deleted() = default;
    Deleted(const Deleted&) = delete;
};

// private ç‰ˆæœ¬
class Private {
public:
    Private() = default;
private:
    Private(const Private&);
};

int main() {
    Deleted d1;
    // Deleted d2 = d1; // Compile error: deleted
    
    Private p1;
    // Private p2 = p1; // Compile error: private (C++11+)
    // In C++98: Link error if not called
    return 0;
}
```

#### ç¤ºä¾‹ 3ï¼šå•ä¾‹æ¨¡å¼ï¼ˆ=deleteï¼‰
```cpp
class Singleton {
    Singleton() = default; // private constructor
public:
    static Singleton& instance() {
        static Singleton instance;
        return instance;
    }
    
    // ç¦æ­¢æ‹·è´
    Singleton(const Singleton&) = delete;
    Singleton& operator=(const Singleton&) = delete;
};

int main() {
    Singleton& s = Singleton::instance();
    // Singleton s2 = s; // Error! deleted
    return 0;
}
```

---

### ğŸ“ å…­ã€åˆ†å±‚ç»ƒä¹ é¢˜

#### ğŸ”¹ åŸºç¡€é¢˜
1. **=delete è¯­æ³•**  
   - ä¸º `MyClass` ç¦æ­¢æ‹·è´æ„é€ å’Œæ‹·è´èµ‹å€¼

2. **èµ„æºç‹¬å **  
   - ä¸º `MutexLock` ç±»ç¦æ­¢æ‹·è´

#### ğŸ”¸ è¿›é˜¶é¢˜
3. **ç§»åŠ¨è¯­ä¹‰**  
   - ä¸º `UniqueResource` å®ç°ç§»åŠ¨æ„é€ /èµ‹å€¼

4. **éªŒè¯**  
   - ç”¨ `static_assert` éªŒè¯ç±»ä¸å¯æ‹·è´

#### âš ï¸ é™·é˜±é¢˜ï¼ˆJava è¿ç§»è¯¯åŒºï¼‰
5. **â€œprivate å°±å¤Ÿäº†å§ï¼Ÿâ€**  
   - Q: C++ ç”¨ `private` ç¦æ­¢æ‹·è´å’Œ `=delete` ä¸€æ ·å—ï¼Ÿ  
   - A: âŒ **ä¸ä¸€æ ·**ï¼  
     â†’ `private`: **é“¾æ¥æ—¶é”™è¯¯**ï¼ˆC++98 å¯èƒ½æ— é”™è¯¯ï¼‰  
     â†’ `=delete`: **ç¼–è¯‘æ—¶é”™è¯¯**ï¼ˆæ›´æ—©ã€æ›´å®‰å…¨ï¼‰

6. **â€œç¦æ­¢æ‹·è´åè¿˜èƒ½ç§»åŠ¨å§ï¼Ÿâ€**  
   - Q: `=delete` æ‹·è´åï¼Œç§»åŠ¨è¯­ä¹‰è¿˜èƒ½ç”¨å—ï¼Ÿ  
   - A: âœ… **å¯ä»¥**ï¼  
     â†’ **ç¦æ­¢æ‹·è´ â‰  ç¦æ­¢ç§»åŠ¨**  
     â†’ `unique_ptr` è¯­ä¹‰ï¼š**ç‹¬å ä½†å¯è½¬ç§»**

---

### âš ï¸ ä¸ƒã€æ³¨æ„äº‹é¡¹ä¸å»ºè®®

| é—®é¢˜ | å»ºè®® |
|------|------|
| **=delete ä½ç½®** | å£°æ˜å¤„ï¼ˆpublic/private çš†å¯ï¼Œä½† public æ›´æ¸…æ™°ï¼‰ |
| **ç§»åŠ¨è¯­ä¹‰** | èµ„æºç‹¬å ç±»é€šå¸¸æ”¯æŒç§»åŠ¨ï¼ˆunique_ptr è¯­ä¹‰ï¼‰ |
| **noexcept** | ç§»åŠ¨å‡½æ•°å¿…é¡» noexcept |
| **ç°ä»£å®è·µ** | ä¼˜å…ˆ `=delete` è€Œé `private` |

> ğŸ’¡ **ç°ä»£ C++ é»„é‡‘æ³•åˆ™**ï¼š  
> **â€œ=delete æ˜ç¡®ç¦æ­¢ï¼›èµ„æºç‹¬å æ”¯æŒç§»åŠ¨ï¼›noexcept ç§»åŠ¨å‡½æ•°â€**

---

### ğŸ” å…«ã€èºæ—‹å¤ä¹ 

- **è¡”æ¥ 2.4.6**ï¼š=delete æ˜¯æ§åˆ¶ç”Ÿæˆè¡Œä¸ºçš„å·¥å…·  
- **Java ç»éªŒ**ï¼šC++ =delete æ¯” Java private æ›´å®‰å…¨  
- **å½“æ—¥å¤ä¹ **ï¼šé»˜å†™ =delete çš„ä¸‰å¤§ä¼˜åŠ¿

---

### ğŸ§  ä¹ã€ä¸»åŠ¨ learning ä»»åŠ¡

1. **è‡ªæˆ‘æé—®**ï¼š
   - â€œå¦‚ä½•ç”¨ =delete ç¦æ­¢æ¨¡æ¿ç‰¹åŒ–ï¼Ÿâ€
   - â€œ=delete å¦‚ä½•ä¸ conceptsï¼ˆC++20ï¼‰äº¤äº’ï¼Ÿâ€
2. **æ¦‚å¿µå›¾**ï¼šç”»å‡º =delete ä¸ private å¯¹æ¯”
3. **æ‰®æ¼”æ•™å¸ˆ**ï¼šå‘åŒäº‹è§£é‡Šâ€œä¸ºä»€ä¹ˆèµ„æºç‹¬å ç±»è¦ =delete æ‹·è´â€

---

### ğŸ” åã€å¤ç›˜æ¸…å•

âœ… æˆ‘èƒ½æ­£ç¡®ä½¿ç”¨ =delete ç¦æ­¢æ‹·è´  
âœ… æˆ‘ç†è§£å…¶ä¸ private çš„å·®å¼‚  
âœ… æˆ‘ä¼šå®ç°ç‹¬å èµ„æºç±»  
âœ… æˆ‘çŸ¥é“ä¸ Java ç¦æ­¢æ‹·è´çš„å¯¹æ¯”  
âœ… æˆ‘æ˜ç™½ç°ä»£ C++ çš„ç¦æ­¢æ‹·è´æœ€ä½³å®è·µ

> ğŸ¯ **è¾¾æ ‡æ ‡å‡†**ï¼šå®ŒæˆåŸºç¡€é¢˜ + æ­£ç¡®åˆ†æé™·é˜±é¢˜ 5 å’Œ 6

---

## ğŸš€ ä¸‹ä¸€æ­¥å»ºè®®

ä½ å·²æŒæ¡ **C++ ç¦æ­¢æ‹·è´ï¼ˆ=deleteï¼‰çš„æ ¸å¿ƒçŸ¥è¯†**ï¼

æ¥ä¸‹æ¥ä½ å¯ä»¥ï¼š
1. **ç»§ç»­å­¦ä¹  2.5 ç§»åŠ¨è¯­ä¹‰è¯¦è§£ï¼ˆå³å€¼å¼•ç”¨ã€std::moveï¼‰**
2. **è¯·æ±‚ç”Ÿæˆã€ŒC++ =delete é€ŸæŸ¥å¡ã€**
3. **è·³è½¬åˆ°ç»ƒä¹ é¢˜ç­”æ¡ˆä¸è§£æ**

è¯·å‘Šè¯‰æˆ‘ä½ çš„é€‰æ‹©ï¼Œæˆ‘ä»¬å°†ç»§ç»­å‰è¡Œï¼