## **编译错误、运行时错误与逻辑错误的分类、诊断与调试策略**  

---

### 【第 1 步：引入动机——错误不是敌人，是老师】（15:00–15:10）

> 同学，你已经写了十几个 C++ 程序，也见过不少红字报错。  
>  
> 很多人一看到错误就慌，觉得“我又搞砸了”。  
>  
> 但今天我要告诉你：**错误不是失败，而是系统在教你如何更精确地思考**。  
>  
> 在 C++ 里，错误分三类，每类都在用不同方式“说话”：  
> - **编译错误**：在你写完就立刻喊停——“这不对，别往下走了！”  
> - **运行时错误**：程序跑着跑着突然崩溃——“你喂了我不能吃的东西！”  
> - **逻辑错误**：程序安静地输出错误答案——“你步骤对了，但心思错了。”  
>  
> 今天这 90 分钟，我们要学会**听懂错误的语言**，并快速修复它。  
>  
> 准备好当一名“错误侦探”了吗？

---

### 【第 2 步：三类错误详解——它们长什么样？】（15:10–15:30）

> **第一类：编译错误（Compile-Time Error）**  
> - **发生时机**：你敲下 `g++` 的瞬间；  
> - **典型表现**：满屏红字，**无法生成可执行文件**；  
> - **常见原因**：  
>   - 缺分号、花括号不配对；  
>   - 拼错 `main`；  
>   - 忘记 `#include <iostream>`；  
>   - `auto x;`（未初始化）。  
> - **关键特征**：**100% 可复现，编译器会告诉你哪一行错了**。

> **第二类：运行时错误（Runtime Error）**  
> - **发生时机**：程序已经跑起来了，但中途崩溃或行为异常；  
> - **本阶段典型表现**：  
>   - 输入字母给 `int`，导致后续 `cin` 全部跳过；  
>   - 程序“卡住”或输出垃圾值；  
> - **关键特征**：**能编译，但运行不正常**。

> **第三类：逻辑错误（Logic Error）**  
> - **发生时机**：程序顺利运行并退出，但结果错了；  
> - **典型表现**：  
>   - `5 / 2` 输出 2，你却以为是 2.5；  
>   - 把 `a + b` 写成 `a - b`；  
>   - 未初始化变量，输出随机数。  
> - **关键特征**：**最危险！因为你看不出它错了**。

> **生活化比喻**：  
> > “编译错误 = 你交作文，老师说‘错别字太多，重写’；  
> > 运行时错误 = 你按菜谱炒菜，锅突然着火；  
> > 逻辑错误 = 你算账，加法全对，但抄错了一个数字——结果错了，你还以为对。”

---

### 【第 3 步：调试策略示范——手把手修一个“三错合一”程序】（15:30–15:50）

> 看这段代码（它同时包含三类错误）：
> ```cpp
> #include <iostream>
> int main {
>     auto a, b;
>     std::cin >> a >> b;
>     std::cout << "Sum: " << a + b << std::endl
>     return 0;
> }
> ```

> **第一步：编译 → 暴露编译错误**  
> 你会看到：
> ```
> error: 'int main' must be 'int main()'
> error: declaration of 'auto a' has no initializer
> error: expected ';' before 'return'
> ```
> → 修复：  
> - `int main()`  
> - 改 `auto` 为 `int a, b;`（或初始化 `auto a = 0, b = 0;`）  
> - 补分号。

> **第二步：运行 → 测试运行时错误**  
> 输入：`10 abc`  
> → 观察：`b` 可能为 0，程序“看似正常”，但实际输入流已失败。  
> → 防御：加 `if (std::cin.fail()) { ... }`。

> **第三步：验证 → 暴露逻辑错误**  
> 输入：`5 2`，期望和为 7，但如果写成 `a / b`，结果就是 2（整数除法）。  
> → 防御：用 `double`，或写 `5.0 / 2`。

> **核心心得**：**修复要分层——先让程序能跑，再让它跑对，最后让它跑稳**。

---

### 【第 4 步：动手实战——你来当侦探】（15:50–16:20）

> 现在轮到你了：

> **【基础任务】错误分类挑战（20 分钟）**  
> 判断以下代码的错误类型，再验证：
> ```cpp
> // A
> int x = 5;
> if (x = 10) { ... } // 意图是比较

> // B
> std::cout << "Hello" << std::endl // 缺分号

> // C
> int y; std::cout << y; // 未初始化
> ```

> **【进阶任务】修复“病态计算器”（25 分钟）**  
> 1. 修复语法错误；  
> 2. 改用 `int` 避免 `auto` 问题；  
> 3. 添加输入验证：
>    ```cpp
>    if (std::cin.fail()) {
>        std::cout << "⚠️ Invalid input!\n";
>        return 1;
>    }
>    ```

> **【陷阱任务】逻辑陷阱深挖（5 分钟）**  
> 为什么 `if (x = 5)` 能编译？  
> → 因为 `=` 是赋值表达式，返回 `5`（非零 → `true`）。  
> **如何避免？**  
> - 开启编译器警告：`g++ -Wall`；  
> - 养成习惯：**常量放左边** → `if (5 == x)`，若误写 `=` 会编译报错。

---

### 【第 5 步：即时反馈——为什么逻辑错误最危险？】（16:20–16:25）

> 编译错误会拦住你，运行时错误会让你警觉，  
> 但**逻辑错误会悄悄骗你**——程序安静地输出错误答案，你还以为成功了。  
>  
> 这就是为什么：  
> - **测试用例比代码更重要**；  
> - **边界值（0, 负数, 极大值）必须验证**；  
> - **中间结果要输出检查**。  
>  
> 在工程中，**发现逻辑错误的成本，远高于预防它的成本**。

---

### 【第 6 步：总结 + 衔接下一阶段】（16:25–16:30）

> 今天我们完成了“错误侦探”训练：  
>  
> ✅ 能区分三类错误；  
> ✅ 掌握了每类的调试策略；  
> ✅ 亲手修复了混合错误程序。  
>  
> 但光会修还不够——你需要**综合应用所有知识，完成一个真实小项目**。  
>  
> 下一阶段（16:30–18:00），我们将开发 **单位转换器（英寸↔厘米）**：  
> - 支持双向转换；  
> - 包含输入验证；  
> - 代码风格规范；  
> - 能处理常见错误。  
>  
> 而你今天学的调试技能，将成为项目自测的核心武器。  
>  
> 准备好从“练兵”进入“实战”了吗？我们继续。

---

> 📌 **教学原则达成检查**：  
> - ✅ 结构先行：以“分类 → 策略 → 示范 → 实战”为认知闭环；  
> - ✅ 生活化比喻：“作文错别字 vs 炒菜着火 vs 算账抄错”贯穿三类错误；  
> - ✅ 动手为王：三层任务（分类/修复/陷阱），含真实错误场景；  
> - ✅ 防错前置：强调逻辑错误隐蔽性、`=` vs `==`、输入验证；  
> - ✅ 衔接清晰：为16:30–18:00的单位转换器项目提供调试与防御能力支撑。

