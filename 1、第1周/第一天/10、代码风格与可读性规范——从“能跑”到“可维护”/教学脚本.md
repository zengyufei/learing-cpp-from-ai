## **代码风格与可读性规范——从“能跑”到“可维护”**  

---

### 【第 1 步：动机引入——你的代码，别人能看懂吗？】（13:30–13:40）

> 同学，恭喜你已经能写出**能跑的 C++ 程序**。  
>  
> 但我要问你一个问题：  
> **如果三个月后，你自己回看今天的代码，能立刻明白它在做什么吗？**  
>  
> 更现实的是：**如果同事接手你的代码，他会不会骂你？**  
>  
> 在真实世界，**写代码不是为了机器，而是为了人**——包括未来的你自己。  
>  
> 今天这 90 分钟，我们要学习 **代码风格与可读性**，让你的程序不仅“能跑”，而且“好看、好懂、好维护”。  
>  
> 这不是“花架子”，而是**专业程序员的基本素养**。

---

### 【第 2 步：风格价值——为什么缩进和命名如此重要？】（13:40–13:50）

> 很多人觉得：“只要程序能跑，格式无所谓。”  
>  
> 但现实是：  
> - 软件 80% 的成本花在**维护**，不是开发；  
> - 你读代码的时间，是写代码的 **10 倍以上**；  
> - 一个模糊的变量名，可能让你多花 30 分钟 debug。
>  
> **生活化比喻**：  
> > “语法正确的代码，像一封没有标点、没有分段的信：  
> > ‘亲爱的你好吗我今天很好天气不错’  
> >  
> > 风格良好的代码，像排版清晰的书信：  
> > ‘亲爱的，  
> > 你好吗？  
> > 我今天很好。天气不错。’  
> >  
> > 内容一样，但后者一眼看懂。”

> 在 C++ 社区，**Google C++ Style Guide** 是事实标准。我们今天学它的精华版。

---

### 【第 3 步：核心规范——四条铁律，让你的代码变“专业”】（13:50–14:10）

> 记住这四条，你的代码立刻提升一个档次：

> **1. 命名：见名知意**  
> - 变量/函数：**小驼峰** → `userName`, `convertFahrenheitToCelsius`；  
> - 常量：**全大写+下划线** → `MAX_RETRY_COUNT`, `PI`；  
> - ❌ 禁止：`x`, `data1`, `temp`（除非是循环计数器 `i`）。

> **2. 缩进与空格：呼吸感**  
> - 缩进：**2 空格**（不用 Tab！不同编辑器 Tab 宽度不同）；  
> - 运算符两侧加空格：`a = b + c;` ✅，`a=b+c;` ❌；  
> - 逗号后加空格：`func(a, b, c)` ✅。

> **3. 空行：逻辑分段**  
> - 函数之间空一行；  
> - 输入 / 计算 / 输出三大块之间空一行；  
> - 让代码有“段落感”。

> **4. 注释：解释“为什么”，不是“做什么”**  
> - ✅ 好注释：“// 使用 5.0/9.0 避免整数除法截断”；  
> - ❌ 坏注释：“// i++ 增加 i”（代码已说明）；  
> - ⚠️ 最危险：**过期注释**（代码改了，注释没改）。

---

### 【第 4 步：重构示范——把“能跑”变成“好看”】（14:10–14:25）

> 看你上午写的温度转换器（原始版）：
> ```cpp
> #include <iostream>
> int main(){
> double f;std::cin>>f;
> const double r=5.0/9.0;
> double c=(f-32)*r;
> std::cout<<c<<std::endl;
> return 0;}
> ```

> 现在，我们一步步重构：

> **第一步：命名升级**  
> - `f` → `fahrenheit`  
> - `c` → `celsius`  
> - `r` → `FAHRENHEIT_TO_CELSIUS_RATIO`

> **第二步：格式化**  
> - 加缩进（2 空格）；  
> - 运算符加空格；  
> - 函数体分块。

> **第三步：加注释**  
> - 在公式前说明意图。

> **重构后**：
> ```cpp
> #include <iostream>

> int main() {
>   std::cout << "Enter temperature in Fahrenheit: ";
>   double fahrenheit;
>   std::cin >> fahrenheit;

>   // Conversion ratio: C = (F - 32) * 5/9
>   const double FAHRENHEIT_TO_CELSIUS_RATIO = 5.0 / 9.0;
>   double celsius = (fahrenheit - 32) * FAHRENHEIT_TO_CELSIUS_RATIO;

>   std::cout << "Celsius: " << celsius << std::endl;
>   return 0;
> }
> ```

> 看——**功能完全一样，但阅读体验天壤之别**。

---

### 【第 5 步：动手练习——你来当“代码医生”】（14:25–14:50）

> 现在轮到你了：

> **【基础任务】风格诊断（20 分钟）**  
> 给你一段“病代码”：
> ```cpp
> #include <iostream>
> int main(){int a;std::cin>>a;double b=(a-32)*5/9;std::cout<<b;}
> ```
> 请指出至少 5 处风格问题，并说明如何改进。

> **【进阶任务】重构你的温度转换器（25 分钟）**  
> 1. 使用有意义的变量名；  
> 2. 常量全大写；  
> 3. 2 空格缩进；  
> 4. 运算符加空格；  
> 5. 逻辑分块（输入 / 计算 / 输出）；  
> 6. 添加一行注释解释公式。

> **【陷阱任务】注释陷阱（5 分钟）**  
> 看这段代码：
> ```cpp
> // Convert Fahrenheit to Celsius
> double c = (f + 32) * 5.0 / 9.0; // 注意：这里是 +32！
> ```
> 问：注释说“转摄氏”，但公式是 `+32`，正确应为 `-32`。  
> **哪种更危险？**  
> - A) 无注释，但代码正确；  
> - B) 有注释，但注释与代码矛盾。  
> （答案：B！因为会误导你相信错误逻辑）

---

### 【第 6 步：即时反馈——风格不是“对错”，而是“成本”】（14:50–14:55）

> 有同学问：“风格又不报错，为什么花时间？”  
>  
> 答：**风格错误不会让编译器报错，但会让同事崩溃、让自己返工**。  
>  
> 一个模糊的 `x`，可能让你多花 10 分钟猜它是什么；  
> 一段无空行的代码，可能让你漏看一个 `;`，引入逻辑 bug。  
>  
> **在工程中，可读性 = 可靠性 = 效率**。  
>  
> 今天花 10 分钟写好风格，未来省 1 小时 debug。

---

### 【第 7 步：总结 + 衔接下一阶段】（14:55–15:00）

> 今天我们完成了从“脚本编写者”到“准工程师”的第一步：  
>  
> ✅ 理解了代码风格的价值；  
> ✅ 掌握了命名、缩进、注释的核心规范；  
> ✅ 亲手重构了你的第一个专业级程序。  
>  
> 但光有好风格还不够——你还需要**理解错误的本质**。  
>  
> 下一阶段（15:00–16:30），我们将系统学习 **三类错误的分类与调试策略**：  
> - 为什么有些错编译器能抓，有些不能？  
> - 如何从红字中提取关键线索？  
> - 如何避免“改了一个 bug，引入两个新 bug”？  
>  
> 而你今天写的清晰代码，将成为调试的最佳起点。  
>  
> 准备好进入“错误侦探”模式了吗？我们继续。

---

> 📌 **教学原则达成检查**：  
> - ✅ 结构先行：以“价值 → 规范 → 重构 → 练习”为逻辑链；  
> - ✅ 生活化比喻：“无标点信 vs 排版书信”贯穿风格讲解；  
> - ✅ 动手为王：三项任务（诊断/重构/注释陷阱），基于真实代码；  
> - ✅ 防错前置：强调过期注释、模糊命名等隐蔽风险；  
> - ✅ 衔接清晰：为下一阶段“错误分类与调试”提供可读代码基础。
