## **运算符与表达式——C++ 的数学与逻辑引擎**  

---

### 【第 1 步：引入动机——让程序学会“思考”】（09:00–09:10）

> 同学，到目前为止，你的程序能说话、能记事、能和你对话。  
>  
> 但它还不会**思考**——比如判断“谁更大”、计算“打八折后多少钱”、决定“是否满足条件”。  
>  
> 在 C++ 里，思考靠的是 **表达式**，而表达式的“动词”就是 **运算符**。  
>  
> 今天这 90 分钟，我们要给程序装上“大脑”：  
> - 用 `+ - * /` 做数学；  
> - 用 `> == !=` 做比较；  
> - 用 `&& ||` 做逻辑推理；  
> - 用 `++ --` 做计数。  
>  
> 而这一切，都藏在一行行看似简单的表达式里。  
>  
> 准备好让你的程序变聪明了吗？

---

### 【第 2 步：运算符分类——C++ 的“动词表”】（09:10–09:30）

> C++ 的运算符，就像人类语言的动词。我们分几大类：

> **1. 算术运算符（做数学）**  
> - `+`, `-`, `*`, `/`, `%`（取模，只用于整数）  
> - 示例：`int result = 10 % 3; // result = 1`  
> - ⚠️ 注意：`5 / 2` 在 C++ 中等于 **2**，不是 2.5！因为整数除法会**截断小数**。

> **2. 关系运算符（做比较）**  
> - `==`（等于）、`!=`（不等于）、`<`, `>`, `<=`, `>=`  
> - 它们返回 `bool`：`true` 或 `false`  
> - 示例：`bool is_adult = age >= 18;`

> **3. 逻辑运算符（做推理）**  
> - `&&`（与）：两边都真才真；  
> - `||`（或）：一边真就真；  
> - `!`（非）：取反；  
> - ⚡ **短路特性**：`a && b` 中，若 `a` 为假，`b` 根本不会计算！

> **4. 赋值运算符（做更新）**  
> - `=`, `+=`, `-=`, `*=`, `/=`, `%=`  
> - 示例：`x += 5;` 等价于 `x = x + 5;`

> **生活化比喻**：  
> > “算术运算符是计算器；  
> > 关系运算符是天平；  
> > 逻辑运算符是法官（‘且’要两个证据，‘或’有一个就行）；  
> > 赋值运算符是仓库管理员——把新货放进货架。”

---

### 【第 3 步：优先级与结合性——谁先谁后？】（09:30–09:45）

> 表达式 `a + b * c` 先算谁？  
>  
> 答案：**先 `*`，后 `+`** ——因为乘法优先级高于加法。  
>  
> C++ 有一套完整的**运算符优先级表**，但我们记住关键几条就够了：
> ```
> () 最高  
> ++ --  
> * / %  
> + -  
> < <= > >=  
> == !=  
> &&  
> ||  
> = 最低
> ```
>  
> **结合性**决定同级运算顺序：  
> - `a - b - c` 是 `(a - b) - c`（左结合）；  
> - `a = b = 5` 是 `a = (b = 5)`（右结合）。

> **黄金法则**：**不确定时，加括号！**  
> 比如写成 `(a + b) * c`，既清晰又安全。

---

### 【第 4 步：自增/自减——++i 和 i++ 到底差在哪？】（09:45–10:00）

> 这是初学者最困惑的问题之一。我们用实验说话：

> ```cpp
> int x = 5;
> int a = ++x; // 先加1，再赋值 → a=6, x=6
> 
> int y = 5;
> int b = y++; // 先赋值，再加1 → b=5, y=6
> ```
>  
> **口诀**：  
> - `++i`：“我先变，再给你”；  
> - `i++`：“我先给你，再变”。

> **危险陷阱**：  
> ```cpp
> int z = 1;
> int w = z++ + ++z; // ❌ 未定义行为！
> ```
> 不同编译器可能给出不同结果。**永远不要在同一个表达式中多次修改同一个变量**。

> **生活化比喻**：  
> > “`++i` 像你先存 100 块再告诉朋友余额；  
> > `i++` 像你先告诉朋友当前余额，再偷偷存 100 块。”

---

### 【第 5 步：动手实验——写、算、验、思】（10:00–10:20）

> 现在，请你动手验证：

> **【基础任务】表达式计算（20 分钟）**  
> 1. 声明 `int a = 10, b = 3;`；  
> 2. 输出：  
>    - `a / b`（观察是否为 3）；  
>    - `a % b`；  
>    - `(a > 5) && (b < 5)`；  
> 3. 尝试 `5 / 2 * 3.0`，观察结果是 `6.0` 还是 `7.5`？

> **【进阶任务】自增实验（15 分钟）**  
> 4. 编写：
>    ```cpp
>    int i = 2;
>    std::cout << "i++ = " << i++ << ", now i = " << i << "\n";
>    int j = 2;
>    std::cout << "++j = " << ++j << ", now j = " << j << "\n";
>    ```
> 5. 观察输出顺序，理解“先用后变” vs “先变后用”。

> **【陷阱任务】逻辑陷阱（15 分钟）**  
> 6. 预测并验证：
>    ```cpp
>    bool r = 3 < 5 < 2; // 是 true 还是 false？
>    ```
>    （提示：`3 < 5` 是 true（即 1），然后 `1 < 2` 是 true → 最终 true！但逻辑错误）  
> 7. 修复：
>    ```cpp
>    int score = 90;
>    if (score = 100) { ... } // 意图是比较！
>    ```

---

### 【第 6 步：即时反馈——为什么 3 < 5 < 2 是 true？】（10:20–10:25）

> 如果你运行 `3 < 5 < 2`，结果是 **true**，你可能会震惊。  
>  
> 但 C++ 是这么算的：  
> 1. 先算 `3 < 5` → 得到 `true`（即整数 1）；  
> 2. 再算 `1 < 2` → `true`。  
>  
> 所以它**语法正确，逻辑错误**！  
>  
> 正确写法应是：  
> ```cpp
> (3 < 5) && (5 < 2)
> ```
>  
> 这就是为什么：**永远不要连写比较**！C++ 不是数学，它是逐段求值的机器。

---

### 【第 7 步：总结 + 衔接下一阶段】（10:25–10:30）

> 今天我们给程序装上了“思考引擎”：  
>  
> ✅ 掌握了四类核心运算符；  
> ✅ 理解了优先级、结合性、自增差异；  
> ✅ 亲手验证了逻辑陷阱。  
>  
> 但光会计算还不够——程序还需要**根据结果做选择**。  
>  
> 下一阶段（10:30–12:00），我们将学习 **类型转换与 auto 关键字**，让你的程序能安全地在不同类型间“翻译”，并为明天的“条件判断”铺平道路。  
>  
> 而你今天写的每一个表达式，都将成为 `if` 语句中的“判断条件”。  
>  
> 准备好进入类型世界的“翻译官”角色了吗？我们继续。

---

> 📌 **教学原则达成检查**：  
> - ✅ 结构先行：以“运算符分类 → 优先级 → 自增 → 表达式求值”为逻辑链；  
> - ✅ 生活化比喻：“法官”“仓库管理员”“先存钱再告诉朋友”贯穿讲解；  
> - ✅ 动手为王：三层练习（基础/进阶/陷阱），含预测-验证闭环；  
> - ✅ 防错前置：强调连写比较、`=` vs `==`、未定义行为等经典陷阱；  
> - ✅ 衔接清晰：为下一阶段“类型转换”和第 2 天“条件语句”奠定表达式基础。

