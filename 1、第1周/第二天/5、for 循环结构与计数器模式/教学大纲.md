## **for 循环结构与计数器模式**

---

#### **本阶段学习目标**  
1. 掌握 `for` 循环的标准语法结构及其与 `while` 循环的等价关系；  
2. 理解 `for` 循环三部分（初始化、条件、更新）的作用域与执行顺序；  
3. 能熟练应用 `for` 循环实现典型计数场景：固定次数迭代、数组遍历雏形、嵌套循环；  
4. 理解循环变量在 C++11 及以后标准中的作用域规则（仅限循环内）；  
5. 能根据场景选择 `for` 或 `while`：**已知次数用 `for`，未知次数用 `while`**。

---

#### **本阶段知识点分解**

##### 1. **for 循环语法与执行流程**
- **标准语法**：
  ```cpp
  for (初始化; 条件; 更新) {
      // 循环体
  }
  ```
- **执行顺序**：  
  1. 执行 **初始化**（仅一次）；  
  2. 检查 **条件**；  
  3. 若为 `true`，执行循环体；  
  4. 执行 **更新**；  
  5. 回到步骤 2；  
  6. 若条件为 `false`，跳出循环。
- **等价 `while` 形式**：
  ```cpp
  初始化;
  while (条件) {
      // 循环体
      更新;
  }
  ```

##### 2. **循环变量作用域（C++11 起）**
- 在 `for (int i = 0; ...)` 中声明的 `i`，**仅在循环内部可见**；  
- 循环结束后，`i` 不再存在（避免污染外层作用域）；  
- 示例：
  ```cpp
  for (int i = 0; i < 3; i++) {
      std::cout << i << " ";
  }
  // std::cout << i; // 编译错误：i 未声明
  ```

##### 3. **典型应用场景**
- **场景 1：固定次数迭代**  
  ```cpp
  for (int i = 0; i < 10; i++) {
      std::cout << i << "\n";
  }
  ```
- **场景 2：累加/累乘**  
  ```cpp
  int sum = 0;
  for (int i = 1; i <= 100; i++) {
      sum += i;
  }
  ```
- **场景 3：嵌套循环（乘法表）**  
  ```cpp
  for (int i = 1; i <= 9; i++) {
      for (int j = 1; j <= i; j++) {
          std::cout << j << "*" << i << "=" << i*j << "\t";
      }
      std::cout << "\n";
  }
  ```

##### 4. **for vs while：何时用哪个？**
| 场景                     | 推荐结构 | 理由 |
|--------------------------|--------|------|
| 已知迭代次数（如 10 次）     | `for`  | 三要素集中，简洁清晰 |
| 未知次数（如用户重试）     | `while` | 条件动态，退出逻辑复杂 |
| 遍历容器（未来）          | `for`  | 与迭代器天然契合 |
| **生活化比喻**            |        |      |
| `for` 像跑步机设定圈数     |        | “跑 10 圈自动停” |
| `while` 像烧水壶           |        | “水没开就一直烧” |

##### 5. **常见错误与陷阱**
- ❌ **分号误用**：`for (int i=0; i<10; i++); { ... }` → 循环体为空，`{}` 成为独立块；  
- ❌ **条件写错**：`for (int i=0; i<=10; i++)` 多执行一次（边界错误）；  
- ❌ **更新方向错误**：`for (int i=10; i>0; i--)` 正确，但 `i++` 会导致无限循环；  
- ❌ **在循环内修改循环变量**：破坏迭代逻辑，难以调试。

---

#### **本阶段动手练习任务**

- **【基础任务】for 基础训练（30 分钟）**  
  1. 用 `for` 输出 1 到 10；  
  2. 计算 1 到 100 的和；  
  3. 打印倒序：10 到 1；  
  4. 故意在 `for` 后加分号，观察循环体是否执行。

- **【进阶任务】乘法表与累加（40 分钟）**  
  1. 打印九九乘法表（格式对齐）；  
  2. 计算 1! + 2! + ... + 10!（阶乘累加）；  
  3. 对比 `for` 与 `while` 实现同一功能，体会代码简洁性差异。

- **【陷阱任务】作用域与分号陷阱（20 分钟）**  
  1. 尝试在 `for` 循环后访问循环变量 `i`，观察编译错误；  
  2. 修复以下代码（输出为空）：
     ```cpp
     for (int i = 0; i < 5; i++); // 多了一个分号！
     {
         std::cout << i << "\n";
     }
     ```

---

#### **跨阶段综合小测/项目**  
- 本阶段 `for` 能力将直接用于 **19:30–21:00 的数学练习器**：  
  - 用 `for` 控制 10 道题的循环；  
- 同时支撑 **07:30–09:00 的编码训练** 中的阶乘、斐波那契等计数问题。

---

#### **与前后阶段的知识衔接说明**

- **前置依赖**：04:30–06:00 阶段已掌握 `while`，本阶段通过**对比教学**突出 `for` 的简洁性；  
- **后继支撑**：  
  - 07:30–09:00 的编码训练将混合使用 `for` / `while`；  
  - 第 3 周“函数封装”将把乘法表逻辑提取为函数；  
- **螺旋上升点**：  
  - 第 13 周“STL 容器”将使用 `for (auto x : vec)` 范围 for 循环；  
  - 第 14 周“算法”将展示 `std::for_each` 对传统 `for` 的抽象替代。

--- 

> 本阶段通过 `for` 循环的集中语法，让学生体验“已知次数重复”的极致简洁。必须通过亲手编写乘法表、修复分号陷阱，建立对循环三要素位置与作用域的精确感知。`for` 不是 `while` 的替代，而是特定场景的优化表达——选择合适的工具，是工程师的基本素养。