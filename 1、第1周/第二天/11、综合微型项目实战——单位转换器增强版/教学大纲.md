### 第 1 周第 2 天 15:00–16:30 阶段详细教学内容大纲  
**阶段标题：综合微型项目实战——单位转换器增强版（含输入重试与错误处理）**

---

#### **本阶段学习目标**  
1. 综合运用第 2 天所学控制流知识（`if`、`while`、`for`、`break`、`continue`）完成一个功能完整、健壮的小型交互程序；  
2. 实现双向单位转换（英寸↔厘米）并支持用户无限次输入重试；  
3. 在程序中嵌入完整的输入验证与错误恢复机制，防止无限循环与崩溃；  
4. 遵循控制流代码风格规范（条件拆分、嵌套限制、`break` / `continue` 注释），产出可维护代码；  
5. 通过“需求→设计→编码→测试→调试”全流程，体验真实开发闭环。

---

#### **本阶段知识点覆盖与整合**

| 知识模块 | 在项目中的应用 |
|--------|--------------|
| `if-else`（01:30–03:00） | 选项判断、转换方向选择 |
| `while`（04:30–06:00） | 主循环、输入重试循环 |
| `for`（06:00–07:30） | （可选）历史记录打印（如最近 3 次转换） |
| `break` / `continue`（09:00–10:30） | `break` 退出主循环，`continue` 跳过无效输入 |
| 输入验证（03:30–04:30） | `std::cin.fail()` 检测、`clear()` + `ignore()` 恢复 |
| 错误处理（13:30–15:00） | 防御无限循环、边界测试 |
| 代码风格（12:00–13:30） | 条件拆分、注释、缩进、空行 |

---

#### **本阶段项目需求说明**

##### 功能要求
1. **启动时显示菜单**：
   ```
   Unit Converter (Enhanced):
   2. Inches to Centimeters
   3. Centimeters to Inches
   4. Exit
   Choose an option (1-3):
   ```
5. **主循环**：使用 `while (true)` 实现，直到用户选择退出；  
6. **输入验证**：  
   - 选项必须为 1、2 或 3；  
   - 数值输入必须为有效数字；  
   - 无效输入时，**提示错误并重试**（不退出程序）；  
4. **转换计算**：  
   - 1 英寸 = 2.54 厘米；  
   - 使用 `const double` 定义转换系数；  
1. **退出机制**：选择 3 时，输出“Goodbye!”并退出。

##### 非功能要求
- 使用 `const double CM_PER_INCH = 2.54;`；  
- 变量命名清晰（如 `userChoice`, `inputValue`）；  
- 复杂条件拆分为布尔变量；  
- `continue` 和 `break` 必须有注释；  
- 2 空格缩进，逻辑块间空行；  
- 程序结构完整，无语法错误。

---

#### **本阶段开发流程指导**

##### 1. **分步实现策略（推荐顺序）**
- **Step 1**：实现主循环框架（`while (true)` + 菜单显示）；  
- **Step 2**：添加选项读取与验证（`cin.fail()` + 重试）；  
- **Step 3**：实现选项 1 和 2 的转换逻辑；  
- **Step 4**：添加选项 3 的退出逻辑（`break`）；  
- **Step 5**：重构代码风格（命名、注释、条件拆分）。

##### 2. **参考代码骨架（供模仿）**
```cpp
#include <iostream>

int main() {
    const double CM_PER_INCH = 2.54;

    while (true) {
        // 显示菜单
        std::cout << "\nUnit Converter (Enhanced):\n";
        std::cout << "1. Inches to Centimeters\n";
        std::cout << "2. Centimeters to Inches\n";
        std::cout << "3. Exit\n";
        std::cout << "Choose an option (1-3): ";

        int userChoice;
        std::cin >> userChoice;

        // 输入验证：检测类型错误
        if (std::cin.fail()) {
            std::cin.clear();
            std::cin.ignore(1000, '\n');
            std::cout << "Invalid input! Please enter a number.\n";
            continue; // 跳过本次，重试
        }

        // 选项验证
        bool is_convert_in_to_cm = (userChoice == 1);
        bool is_convert_cm_to_in = (userChoice == 2);
        bool is_exit = (userChoice == 3);

        if (is_exit) {
            std::cout << "Goodbye!\n";
            break; // 退出主循环
        }

        if (!is_convert_in_to_cm && !is_convert_cm_to_in) {
            std::cout << "Option must be 1, 2, or 3.\n";
            continue; // 跳过无效选项
        }

        // 读取长度值
        std::cout << "Enter length: ";
        double inputValue;
        std::cin >> inputValue;

        if (std::cin.fail()) {
            std::cin.clear();
            std::cin.ignore(1000, '\n');
            std::cout << "Invalid number! Try again.\n";
            continue; // 跳过无效数值
        }

        // 执行转换
        double result;
        if (is_convert_in_to_cm) {
            result = inputValue * CM_PER_INCH;
            std::cout << "Result: " << result << " cm\n";
        } else {
            result = inputValue / CM_PER_INCH;
            std::cout << "Result: " << result << " in\n";
        }
    }

    return 0;
}
```

---

#### **本阶段动手练习任务**

- **【核心任务】单位转换器增强版开发（70 分钟）**  
  1. 独立编写程序，满足上述功能与非功能要求；  
  2. 测试以下用例：  
     - 正常：选项 1，输入 10 → 输出 25.4；  
     - 正常：选项 2，输入 25.4 → 输出 10；  
     - 异常：输入字母 → “Invalid input! Please enter a number.”；  
     - 异常：输入 4 → “Option must be 1, 2, or 3.”；  
     - 正常：选项 3 → “Goodbye!”并退出。  
  3. 提交源码 + 测试截图。

- **【挑战任务】历史记录（可选，20 分钟）**  
  - 用 `for` 循环存储并打印最近 3 次转换结果；  
  - 为未来数组学习埋下伏笔。

---

#### **跨阶段综合小测/项目**  
- 本项目是 **第 2 天知识整合的里程碑成果**，将作为：  
  - 当日学习成效的直接体现；  
  - 第 5 天“简易计算器”项目的风格与结构模板；  
  - 后续“错题回顾”环节的典型分析案例（如未处理输入错误）。  
- 若项目无法处理基本异常或风格混乱，需在当日内返工。

---

#### **与前后阶段的知识衔接说明**

- **前置依赖**：综合调用 00:00–15:00 所有模块，尤其依赖 **输入验证**（03:30–04:30）与 **错误处理**（13:30–15:00）；  
- **后继支撑**：  
  - 16:30–18:00 的“错误排查与重构”将分析本项目中的潜在逻辑漏洞；  
  - 第 3 天“函数封装”将把转换逻辑提取为独立函数；  
- **螺旋上升点**：  
  - 第 4 周“数组”将扩展历史记录功能；  
  - 第 7 周“文件 I/O”将支持保存转换记录到文件。

--- 

> 本项目虽小，却是学生首次体验“从需求到可运行程序”的完整工程闭环。必须通过亲手处理边界情况、验证输入、规范代码，建立对软件质量的初步敬畏。宁可第一天多花时间打磨，也不让“能跑就行”的心态带入后续复杂主题。