### 第 1 周第 2 天 13:30–15:00 阶段详细教学内容大纲  
**阶段标题：控制流中的三类错误分类、诊断与调试策略**

---

#### **本阶段学习目标**  
1. 能准确区分控制流场景下的三类错误：**编译错误**（语法/结构问题）、**运行时错误**（程序崩溃/异常终止）、**逻辑错误**（结果错误但程序正常结束）；  
2. 掌握针对每类错误的典型表现、根本原因与调试路径，尤其聚焦控制流特有陷阱；  
3. 能通过编译器错误信息快速定位并修复语法问题（如悬空 else、分号缺失）；  
4. 初步建立“防御性编码”意识：通过清晰结构、边界测试、输入验证减少控制流错误；  
5. 形成“错误是反馈，不是失败”的工程心态，将调试视为理解程序执行的窗口。

---

#### **本阶段知识点分解**

##### 1. **三类错误在控制流中的典型表现**
| 错误类型       | 控制流典型场景 | 表现示例 |
|----------------|----------------|--------|
| **编译错误**   | 语法结构错误 | `if (x > 0)` 缺花括号导致悬空 else；`for` 循环分号缺失 |
| **运行时错误** | 无限循环、资源耗尽 | `while` 条件永不为假；`continue` 导致循环变量未更新 |
| **逻辑错误**   | 边界遗漏、条件错 | 闰年判断漏掉 100/400 规则；循环多执行一次（`i <= n` vs `i < n`） |

##### 2. **编译错误（Syntax & Semantic Errors）在控制流中的根源**
- **常见根源**：
  - 悬空 else（花括号缺失）；
  - `for` 循环三要素间缺分号；
  - `if` 条件后误加分号：`if (x > 0); { ... }`；
  - 在循环外使用 `break` / `continue`。
- **调试策略**：
  - **从第一行错误开始修**（后续错误可能是连锁反应）；
  - **理解关键词**：`expected ‘{’`, `‘break’ not within loop`；
  - **最小复现**：注释部分代码，定位错误范围。

##### 3. **运行时错误（Runtime Errors）在控制流中的根源**
- **典型表现**：
  - **无限循环**：循环变量未更新、更新方向错误、条件设计缺陷；
  - **输入流失效**：`cin.fail()` 后未 `clear()`，导致后续输入跳过；
  - **资源耗尽**：嵌套循环层数过多（虽本阶段少见）。
- **调试策略**：
  - **插入计数器**：`int iter = 0; while (cond && iter++ < 1000) ...`；
  - **打印循环变量**：`std::cout << "DEBUG: i=" << i << "\n";`；
  - **设置最大迭代次数**：防止程序“卡死”。

##### 4. **逻辑错误（Logic Errors）在控制流中的根源**
- **常见根源**：
  - **边界条件遗漏**：循环 `i <= n` 多一次，`i < n` 少一次；
  - **条件优先级误解**：`if (a && b || c)` 实为 `if ((a && b) || c)`；
  - **布尔逻辑错误**：闰年条件不全、成绩分级重叠；
  - **`break` / `continue` 误用**：`continue` 跳过必要更新。
- **调试策略**：
  - **手动模拟小输入**：如 `n=0,1,2` 测试循环；
  - **分段验证**：将复杂条件拆为中间变量并输出；
  - **边界测试**：测试循环上下界、条件临界值。

##### 5. **防御性编码习惯（控制流特化）**
- **循环三要素显式化**：初始化、条件、更新清晰分离；
- **复杂条件拆分为布尔变量**：提升可读性与可测性；
- **`while (true)` 必有明确 `break`**：避免退出点分散；
- **`continue` 前确保更新完成**：尤其在 `while` 中；
- **小步提交**：每加一个控制结构，立即测试，避免错误堆积。

##### 6. **生活化比喻强化理解**
- **编译错误** = 作文有错别字或语法错误，老师直接打回；  
- **运行时错误** = 你按说明书操作，但机器突然冒烟（无限循环）；  
- **逻辑错误** = 你算术题步骤全对，但抄错了一个数字，答案错了。

---

#### **本阶段动手练习任务**

- **【基础任务】错误分类挑战（30 分钟）**  
  提供 5 段控制流代码，每段含一种错误，要求学生：  
  1. 预测错误类型（编译/运行时/逻辑）；  
  2. 实际编译/运行验证；  
  3. 修复并说明原因。  
  **示例**：
  ```cpp
  // 1. 编译错误
  for (int i=0 i<10 i++) { ... } // 缺分号

  // 2. 运行时错误
  int i = 0;
  while (i < 5) {
      if (i == 2) continue;
      std::cout << i << "\n";
      // 忘记 i++
  }

  // 3. 逻辑错误
  for (int i = 1; i <= 10; i++) {
      if (i % 2 = 0) std::cout << i << " "; // 赋值而非比较
  }
  ```

- **【进阶任务】调试实战：修复“病态菜单系统”（40 分钟）**  
  提供一个含三类错误的菜单系统：
  ```cpp
  while (true) {
      int choice;
      std::cin >> choice;
      if (choice = 1) { ... } // 逻辑错误：赋值
      else if (choice == 2) {
          double x; std::cin >> x;
          if (std::cin.fail()) continue; // 运行时错误：未 clear()
      }
      // 缺 else if (choice == 3) break; → 逻辑错误：无法退出
  }
  ```
  要求：  
  1. 修复编译错误（如有）；  
  2. 修复运行时错误（无限循环）；  
  3. 修复逻辑错误（无法退出、条件错）。

- **【陷阱任务】边界陷阱深挖（20 分钟）**  
  分析以下代码：
  ```cpp
  for (int i = 0; i <= 10; i++) {
      std::cout << i << "\n";
  }
  ```
  - 循环执行多少次？  
  - 若意图是 1–10，应如何修改？  
  - 讨论：`i < n` vs `i <= n` 的适用场景。

---

#### **跨阶段综合小测/项目**  
- 本阶段调试能力将直接用于 **15:00–16:30 的单位转换器增强版项目** 的自测环节；  
- 项目提交需包含 **错误处理说明**（如“如何应对无限循环”）；  
- 若无法区分三类错误或修复基础语法问题，需在当日补练。

---

#### **与前后阶段的知识衔接说明**

- **前置依赖**：12:00–13:30 阶段强调的清晰命名与结构，**显著降低逻辑错误概率**；  
- **后继支撑**：  
  - 15:00–16:30 的“单位转换器增强版”将综合应用本阶段调试策略；  
  - 第 3 天“函数封装”中函数调用错误将成为新错误来源；  
- **螺旋上升点**：  
  - 第 5 周“调试工具”将引入 `gdb`、断点等高级手段；  
  - 第 7 周“异常处理”将系统化运行时错误的捕获与恢复机制。

--- 

> 本阶段是控制流能力从“写得出”迈向“改得对”的关键跃迁。必须通过亲手制造、分类、修复三类错误，建立对程序生命周期的完整认知。错误不是学习的终点，而是理解的起点——在 C++ 的世界里，每一次崩溃都是系统在教你更精确地思考。