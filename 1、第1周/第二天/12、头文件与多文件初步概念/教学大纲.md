### 第 1 周第 2 天 16:30–18:00 阶段详细教学内容大纲  
**阶段标题：头文件与多文件初步概念（控制流上下文中的模块化意识）**

---

#### **本阶段学习目标**  
1. 在控制流项目背景下，深化理解头文件（header file）的核心作用：**声明接口、分离编译、避免重复定义**；  
2. 能解释 `#include <iostream>` 的实际含义，并区分标准库与自定义头文件的使用场景；  
3. 初步建立“声明 vs 定义”“接口 vs 实现”的模块化编程意识，为第 3 天函数封装铺路；  
4. 理解为何将单位转换逻辑从 `main()` 中分离是代码演进的必然方向；  
5. 为未来多文件项目（第 3 周起）奠定认知基础，避免“所有控制流逻辑塞进 main. Cpp”的坏习惯。

---

#### **本阶段知识点分解**

##### 1. **为什么在控制流项目后讲头文件？——从“大 main”到“模块化”**
- **问题场景**：  
  - 第 2 天项目（单位转换器增强版）的 `main()` 函数已超过 50 行，包含菜单、输入、验证、转换、退出逻辑；  
  - 代码难以阅读、测试、复用；  
  - 若新增“磅↔千克”转换，`main()` 将更臃肿。
- **解决方案**：**分离关注点**  
  - **头文件（`.h`）**：存放**声明**（函数签名、常量声明）；  
  - **源文件（`.cpp`）**：存放**定义**（函数体、主逻辑）；  
  - **`main.cpp`**：仅负责程序流程控制（菜单、循环、调用）。
- **生活化比喻**：  
  > “当前 `main()` 像一个人既当厨师又当服务员还当收银员；  
  > 模块化后，厨师（转换逻辑）专注做菜，服务员（main）专注接待——各司其职。”

##### 2. ** #include 的本质回顾与深化**
- **预处理阶段行为**：  
  - `#include "converter.h"` → 将 `converter.h` 的**全部内容**复制到当前文件该位置；  
  - 效果等同于手动粘贴函数声明。
- **标准库 vs 自定义头文件**：
  - `#include <xxx>`：系统目录（如 `/usr/include`）；  
  - `#include "xxx.h"`：当前项目目录优先。
- **关键认知**：  
  - `#include` **不等于链接**，它只提供**编译期声明**；  
  - 链接阶段才将 `.cpp` 中的定义与调用关联。

##### 3. **声明 vs 定义——C++ 的契约精神（控制流视角）**
- **声明（Declaration）**：  
  - 告诉编译器“某函数存在，长什么样”，不分配内存；  
  - 示例：`double inchesToCentimeters(double inches);`；  
  - 可多次声明，无副作用。
- **定义（Definition）**：  
  - 提供完整实现，分配内存；  
  - 示例：`double inchesToCentimeters(double inches) { return inches * 2.54; }`；  
  - **必须且只能有一次定义**（ODR：One Definition Rule）。
- **错误示例**：  
  - 在头文件中定义非内联函数 → 多文件包含时违反 ODR，链接失败。

##### 4. **自定义头文件的初步规范（意识建立）**
- **命名**：与源文件同名，如 `unit_converter.h` 对应 `unit_converter.cpp`；  
- **基本结构**（第 3 周详述，此处仅展示）：
  ```cpp
  // unit_converter.h
  #ifndef UNIT_CONVERTER_H
  #define UNIT_CONVERTER_H

  const double CM_PER_INCH = 2.54;

  double inchesToCentimeters(double inches);
  double centimetersToInches(double centimeters);

  #endif
  ```
- **当前阶段限制**：  
  - 不要求学生编写自定义头文件；  
  - 仅需理解其存在意义，为第 3 天“函数封装”做铺垫。

##### 5. **控制流项目中的模块化预演**
- **重构愿景**（第 3 天实现）：
  - `main.cpp`：仅含 `while (true)` 主循环、菜单显示、用户输入；  
  - `unit_converter.h`：声明转换函数；  
  - `unit_converter.cpp`：实现转换函数；  
- **优势**：  
  - `main()` 从 50 行减至 20 行，逻辑清晰；  
  - 转换逻辑可独立测试；  
  - 新增单位只需添加新函数，不干扰主流程。

---

#### **本阶段动手练习任务**

- **【基础任务】头文件作用观察（30 分钟）**  
  1. 在单位转换器中，仅包含 `#include <iostream>`，不使用任何 I/O；  
  2. 尝试编译，观察是否成功；  
  3. 删除 `#include <iostream>`，使用 `std::cout`，观察编译错误；  
  4. 结论：`#include` 提供了 `cout` 的**声明**，否则编译器不认识它。

- **【进阶任务】路径差异实验（30 分钟）**  
  1. 创建空文件 `myutils.h` 在当前目录；  
  2. 尝试 `#include "myutils.h"` → 成功；  
  3. 尝试 `#include <myutils.h>` → 失败（除非放入系统目录）；  
  4. 理解双引号 vs 尖括号的搜索优先级。

- **【陷阱任务】重复定义陷阱（30 分钟）**  
  1. 在 `main.cpp` 中直接定义函数：
     ```cpp
     double square(double x) { return x * x; }
     ```
  2. 想象：如果另一个 `.cpp` 文件也需要 `square`，能否直接 `#include "main.cpp"`？  
  3. 讨论：为什么这会导致**重复定义错误**（链接阶段）？  
  4. 引出：**正确做法是声明放 `.h`，定义放 `.cpp`**。

---

#### **跨阶段综合小测/项目**  
- 本阶段概念将直接用于 **第 3 天“函数封装”**：  
  - 学生需为单位转换器编写自定义头文件；  
  - 项目评审将检查是否遵守“声明/定义分离”原则；  
- 若混淆 `#include` 与“链接库”，将在第 7 周“静态/动态库”阶段产生严重认知障碍。

---

#### **与前后阶段的知识衔接说明**

- **前置依赖**：15:00–16:30 阶段的单位转换器项目已暴露“大 main”问题，本阶段**解释模块化解决方案**；  
- **后继支撑**：  
  - 18:00–19:30 的“错误排查与重构”将强调“不要在头文件中放实现”；  
  - 第 3 天“函数封装”将首次编写自定义 `.h` / `.cpp`；  
- **螺旋上升点**：  
  - 第 8 周“常用类库”将深入标准库头文件设计；  
  - 第 11 周“综合项目”将采用多模块头文件组织，回溯本阶段的“厨师 vs 服务员”比喻。

--- 

> 本阶段虽无新语法，但标志着学生从“单文件控制流脚本”迈向“模块化工程思维”的关键转折。必须通过亲手观察 `#include` 的作用、理解声明/定义分离，建立对 C++ 项目结构的宏观认知。宁可第二天多花时间理解“为什么”，也不让“复制粘贴式包含”成为未来项目的隐患。